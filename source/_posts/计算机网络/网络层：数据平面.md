## 路由器工作原理

### 分组调度

排队的分组如何经输出链路传输的问题

#### 1、先进先出

#### 2、优先权排队

- 高优先权类
- 低优先权类

#### 3、循环和加权公平排队



## 网际协议：IPv4、寻址、IPv6及其他

如今有两个版本的IP正在使用：`IPv6`和`IPv4`

### IPv4数据报格式

- 版本（号）
- 首部长度
- 服务类型
- 数据报长度（字节）
- 标识、标志、片偏移
- 寿命
- 协议
- 首部检验和
- 源和目的IP地址
- 选择
- 数据



### IPv4数据报分片

一个链路层帧能承载的最大数据量叫做**最大传送单元（Maximum Transmission Unit，MTU）**

IPv4的设计者决定将数据报的重新组装工作放到端系统中



### IPv4编址

主机与物理链路之间的边界叫做`接口（interface）`，从技术上讲，一个IP地址与一个接口相关联，而不是与包括该接口的主机或者路由器相关联。

#### 1、获取一个地址

#### 2、获取主机地址：动态主机配置协议

- DHCP服务器发现
- DHCP服务器提供
- DHCP请求
- DHCP ACK



### 网络地址转换

NAT路由器



### IPv6

32比特的IP地址即将分配完，所以开发了新的IP协议：IPv6

#### 1、IPv6数据报格式



### 通用转发和SDN



### 小结

我们讨论了网络层的**数据平面（data plane）**功能，即每台路由器的如下功能：决定到达输入链路之一的分组如何转发到该路由器的输出链路之一
